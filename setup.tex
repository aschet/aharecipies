\usepackage{scrlayer-scrpage}
\usepackage[utf8]{inputenc}
\usepackage[american]{babel}
\usepackage[pass]{geometry}
\usepackage[regular,condensed,sfdefault]{roboto}
\usepackage[T1]{fontenc}
\usepackage{fp}
\usepackage{xcolor}
\usepackage{mdframed}
\usepackage{colortbl}
\usepackage{graphicx}
\usepackage{tabu}
\usepackage{booktabs}
\usepackage[version=4]{mhchem}
\usepackage{xifthen}
\usepackage[hidelinks,pdfencoding=auto]{hyperref}
\usepackage{multicol}
\usepackage{microtype}

\addtokomafont{part}{\Huge}
\addtokomafont{chapter}{\Huge}
\addtokomafont{section}{\Huge}

\definecolor{softgray}{HTML}{F1F1F1}
\definecolor{hardgray}{HTML}{6A6A6A}
\chead{}
\setlength{\parindent}{0mm} 
\RedeclareSectionCommand[tocnumwidth=0.85cm]{part}

\newmdenv[linewidth=3pt,
linecolor=black,
backgroundcolor=softgray,
fontcolor=hardgray,
rightline=false,
leftline=false,
bottomline=false,
skipabove=1mm,
skipbelow=1.5mm]{recipeframe}

\newcommand{\stylecategory}[1]{\part{#1}}
\newcommand{\stylesection}[1]{\chapter{#1} \clearpage}

\newenvironment{recipe}[1]{\begin{multicols}{2}[\section*{#1}]}{\end{multicols} \newpage}

\newcommand{\recipebreak}{\vfill\null \columnbreak}

\newenvironment{recipeblock}[1]
{\uppercase{\textbf{#1}} \begin{recipeframe}}{\end{recipeframe}}

\newenvironment{aboutblock}
{\begin{recipeblock}{About This Beer}}{\end{recipeblock}}

\newenvironment{ingredientsblock}
{\begin{recipeblock}{Ingredients}}{\end{recipeblock}}

\newcommand{\recipesection}[2]{
\begin{minipage}[t][1.2cm]{\textwidth}
	\begin{minipage}[c][1.2cm][c]{0.95cm}
		\includegraphics[width=0.8cm]{#1}
	\end{minipage}
	\begin{minipage}[c][1.2cm][c]{5cm}
		\large{\textcolor{black}{\uppercase{\textbf{#2}}}}
	\end{minipage}
	\hfill
\end{minipage}
}

\newcommand{\ftoc}[1]{\FPeval\amountg{round(((#1 - 32.0) / 1.8):0)}\FPprint\amountg ~°C}
\newcommand{\gpgaltogpl}[1]{\FPeval\amountg{round((#1 * 0.264172):1)}\FPprint\amountg ~g/l}
\newcommand{\ozpgaltogpl}[1]{\FPeval\amountg{round((#1 * 7.48915):1)}\FPprint\amountg ~g/l}
\newcommand{\tsptog}[1]{\FPeval\amountg{round((#1 * 4.92892):0)}\FPprint\amountg ~g}
\newcommand{\tbsptog}[1]{\FPeval\amountg{round((#1 * 15.0):0)}\FPprint\amountg ~g}
\newcommand{\oztog}[1]{\FPeval\amountg{round((#1 * 28.34952):0)}\FPprint\amountg ~g}
\newcommand{\oztokg}[1]{\FPeval\amountg{round((#1 * 0.02834952):2)}\FPprint\amountg ~kg}
\newcommand{\lbtokg}[1]{\FPeval\amountg{round((#1 * 0.4535924):2)}\FPprint\amountg ~kg}
\newcommand{\galtol}[1]{\FPeval\amountg{round((#1 * 3.78541):1)}\FPprint\amountg ~l}
\newcommand{\cuptoml}[1]{\FPeval\amountg{round((#1 * 240.0):0)}\FPprint\amountg ~ml}
\newcommand{\tsptoml}[1]{\FPeval\amountg{round((#1 * 4.92892):0)}\FPprint\amountg ~ml}
\newcommand{\srmtoebc}[1]{\FPeval\amountg{round((#1 * 1.97):0)}\FPprint\amountg ~EBC}
\newcommand{\sgtop}[1]{\FPeval\amountg{round((135.997 * pow(3,#1) - 630.272 * pow(2,#1) + 1111.14 * #1 - 616.868):1)}\FPprint\amountg ~°P}
\newcommand{\voltogl}[1]{\FPeval\amountg{round((#1 * 1.96):1)}\FPprint\amountg ~g/l (#1 vol)}



\newcommand{\specitem}[1]{\textcolor{black}{\uppercase{\textbf{#1}}}}

\newenvironment{malts} {\recipesection{images/malt.pdf}{Malt / Mash Additions}
\begin{tabu} to \textwidth {Xr}
\textbf{Name} & \textbf{Amount} \\ \midrule}{\end{tabu}}
\newcommand{\malt}[2]{#1 & #2 \\ \midrule}

\newenvironment{hops} {\recipesection{images/hop.pdf}{Hops / Boil Additions}
\begin{tabu} to \textwidth {Xcr}
\textbf{Name} & \textbf{Addition} & \textbf{Amount} \\ \midrule}{\end{tabu}
{\centering\small{FWP = first wort hopping, FO = flameout, WP = whirlpool, DHBT =
biotransformation, DH = dry hopping} \par}}
\newcommand{\hop}[4]{#1 \ifthenelse{\isempty{#2}}{}{(#2)} & \ifthenelse{\isempty{#3}}{--}{#3} & #4 \\ \midrule}

\newenvironment{yeastsx} {\recipesection{images/yeast.pdf}{Yeast}
\begin{tabu} to \textwidth {Xr}
\textbf{Name} & \textbf{Addition} \\ \midrule}{\end{tabu}}
\newcommand{\yeastx}[2]{#1 & #2 \\ \midrule}

\newenvironment{yeasts} {\recipesection{images/yeast.pdf}{Yeast}
\begin{tabu} to \textwidth {X}}{\end{tabu}}
\newcommand{\yeast}[1]{#1 \\ \midrule}

\newcommand{\singleyeast}[1]{
\begin{yeasts}
\yeast{#1}
\end{yeasts}
}

\newenvironment{twists} {\recipesection{images/star.pdf}{Fermentation Additons}
\begin{tabu} to \textwidth {Xcr}
\textbf{Name} & \textbf{Addition} & \textbf{Amount} \\ \midrule}{\end{tabu}}
\newcommand{\twist}[3]{#1 & \ifthenelse{\isempty{#2}}{--}{#2} & #3 \\ \midrule}

\newenvironment{mashsteps} {\recipesection{images/mash.pdf}{Mash}
\begin{tabu} to \textwidth {Xr}}{\end{tabu}}
\newcommand{\mashstep}[2]{#1 & #2 \\ \midrule}
\newcommand{\mashdecoctthin}[1]{\mashstep{}{Thin decoction #1}}
\newcommand{\mashdecoctthick}[1]{\mashstep{}{Thick decoction #1}}
\newcommand{\mashdecoctboil}[1]{\mashstep{\ftoc{212}}{Boil #1}}
\newcommand{\mashdecoctreturn}[2]{\mashstep{#1}{Return to main mash\ifthenelse{\isempty{#2}}{}{; #2}}}

\newenvironment{fermentationsteps} {\recipesection{images/ferment.pdf}{Fermentation} 
\begin{tabu} to \textwidth {Xr}}{\end{tabu}}
\newcommand{\fermentationstep}[2]{#1 & #2 \\ \midrule}

\newenvironment{directions} {\recipesection{images/bulp.pdf}{Directions}}{}

\newenvironment{methodandtiming} {\begin{recipeblock}{Method / Timings}}{\end{recipeblock}}

\newenvironment{yeastinfos}[1] {\begin{recipeblock}{#1} 
\begin{tabu} to \textwidth {lX}}{\end{tabu}
\end{recipeblock}}
\newcommand{\yeastinfo}[2]{#1 & #2 \\ \midrule}

\newcommand{\dryhbt}[2]{DHBT\ifthenelse{\isempty{#1}}{}{\textsubscript{#1}}\ifthenelse{\isempty{#2}}{}{ (#2)}}
\newcommand{\dryh}[2]{DH\ifthenelse{\isempty{#1}}{}{\textsubscript{#1}}\ifthenelse{\isempty{#2}}{}{ (#2)}}
\newcommand{\whirl}[2]{WP\ifthenelse{\isempty{#1}}{}{\textsubscript{#1}}\ifthenelse{\isempty{#2}}{}{ (#2)}}
\newcommand{\fwh}{FWH}
\newcommand{\foh}[1]{FO\ifthenelse{\isempty{#1}}{}{ (#1)}}

\newcommand{\hopahtanum}{Ahtanum}
\newcommand{\hopamarillo}{Amarillo}
\newcommand{\hopapollo}{Apollo}
\newcommand{\hopbravo}{Bravo}
\newcommand{\hopcalypso}{Calypso}
\newcommand{\hopcascade}{Cascade}
\newcommand{\hopcentennial}{Centennial}
\newcommand{\hopchallenger}{Challenger}
\newcommand{\hopchinook}{Chinook}
\newcommand{\hopcitra}{Citra}
\newcommand{\hopcolumbus}{Columbus}
\newcommand{\hopcrystal}{Crystal}
\newcommand{\hopeastkentgolding}{East Kent Golding}
\newcommand{\hopeldorado}{El Dorado}
\newcommand{\hopeureka}{Eureka}
\newcommand{\hopfalconersflight}{Falconer's Flight}
\newcommand{\hopfuggle}{Fuggle}
\newcommand{\hopgalaxy}{Galaxy}
\newcommand{\hopgolding}{Golding}
\newcommand{\hophallertaumittelfruh}{Hallertau Mittelfrüh}
\newcommand{\hophallertautradition}{Hallertau Tradition}
\newcommand{\hophorizon}{Horizon}
\newcommand{\hopidahoseven}{Idaho 7}
\newcommand{\hopkohatu}{Kohatu}
\newcommand{\hoplemondrop}{Lemondrop}
\newcommand{\hopliberty}{Liberty}
\newcommand{\hoplubelska}{Lubelska}
\newcommand{\hopmagnum}{Magnum}
\newcommand{\hopmandarinabavaria}{Mandarina Bavaria}
\newcommand{\hopmarynka}{Marynka}
\newcommand{\hopmosaic}{Mosaic}
\newcommand{\hopmotueka}{Motueka}
\newcommand{\hopmthood}{Mt. Hood}
\newcommand{\hopnelsonsauvin}{Nelson Sauvin}
\newcommand{\hopnorthernbrewer}{Northern Brewer}
\newcommand{\hopnugget}{Nugget}
\newcommand{\hoppacifica}{Pacifica}
\newcommand{\hoppacificgem}{Pacific Gem}
\newcommand{\hoppacificjade}{Pacific Jade}
\newcommand{\hoppalisade}{Palisade}
\newcommand{\hopperle}{Perle}
\newcommand{\hoppolaris}{Polaris}
\newcommand{\hoprakau}{Rakau}
\newcommand{\hopsaaz}{Saaz}
\newcommand{\hopsantiam}{Santiam}
\newcommand{\hopsimcoe}{Simcoe}
\newcommand{\hopspalt}{Spalt}
\newcommand{\hopspaltselect}{Spalt Select}
\newcommand{\hopsterling}{Sterling}
\newcommand{\hopstrisselspalt}{Strisselspalt}
\newcommand{\hopstyriangolding}{Styrian Golding}
\newcommand{\hopsummit}{Summit}
\newcommand{\hoptarget}{Target}
\newcommand{\hoptettnang}{Tettnang}
\newcommand{\hopvanguard}{Vanguard}
\newcommand{\hopvicsecret}{Vic Secret}
\newcommand{\hopwakatu}{Wakatu}
\newcommand{\hopwarrior}{Warrior}
\newcommand{\hopwillamette}{Willamette}
\newcommand{\hopzythos}{Zythos}

% Light Lager
\newcommand{\styleamericanlager}{American Lager}
\newcommand{\stylemunichhelles}{Munich Helles}
\newcommand{\stylefestbier}{Festbier}

% Pilsner
\newcommand{\stylegermanpils}{German Pils}
\newcommand{\styleczechpremiumpalelager}{Czech Premium Pale Lager}

% European Amber Lager
\newcommand{\styleviennalager}{Vienna Lager}

% Bock
\newcommand{\stylehellesbock}{Helles Bock}
\newcommand{\styledopplebock}{Dopplebock}

% Dark Lager
\newcommand{\stylemunichdunkel}{Munich Dunkel}
\newcommand{\styleschwarzbier}{Schwarzbier}

% Light Hybrid Beer
\newcommand{\stylecreamale}{Cream Ale}
\newcommand{\styleblondeale}{Blonde Ale}
\newcommand{\styleamericanwheat}{American Wheat}

% Amber Hybrid Beer
\newcommand{\styleinternationalamberlager}{International Amber Lager}
\newcommand{\stylecaliforniacommon}{California Common}

% English Pale Ale
\newcommand{\styleordinarybitter}{Ordinary Bitter}
\newcommand{\stylestrongbitter}{Strong Bitter}

% Scottish & Irish Ale
\newcommand{\stylescottishlight}{Scottish Light}
\newcommand{\styleirishredale}{Irish Red Ale}

% American Pale Ale
\newcommand{\styleamericanpaleale}{American Pale Ale}

% Other American Ale
\newcommand{\styleamericanamberale}{American Amber Ale}

% English Brown Ale
\newcommand{\styledarkmild}{Dark Mild}
\newcommand{\stylebritishbrownale}{British Brown Ale}

% Porter
\newcommand{\styleenglishporter}{English Porter}
\newcommand{\styleamericanporter}{American Porter}
\newcommand{\stylebalticporter}{Baltic Porter}

% Stout
\newcommand{\styleoatmealstout}{Oatmeal Stout}
\newcommand{\stylesweetstout}{Sweet Stout}

% Strong Stout
\newcommand{\styleamericanstout}{American Stout}
\newcommand{\styleimperialstout}{Imperial Stout}

% American IPA
\newcommand{\styleamericanipa}{American IPA}

% India Pale Ale
\newcommand{\styleindiapaleale}{India Pale Ale}
\newcommand{\styleryeipa}{Specialty IPA: Rye IPA}

% German Wheat Rye Beer
\newcommand{\styleweissbier}{Weissbier}

% Belgian & French Al
\newcommand{\stylewitbier}{Witbier}
\newcommand{\stylebelgianpaleale}{Belgian Pale Ale}
\newcommand{\stylesaison}{Saison}

% Belgian Strong Ale
\newcommand{\stylebelgianblondale}{Belgian Blond Ale}
\newcommand{\stylebelgiandubbel}{Belgian Dubbel}
\newcommand{\stylebelgiangoldenstrongale}{Belgian Golden Strong Ale}
\newcommand{\stylebelgiandarkstrongale}{Belgian Dark Strong Ale}

% Strong Ale
\newcommand{\styleoldale}{Old Ale}
\newcommand{\styleenglishbarleywine}{English Barleywine}
\newcommand{\styleamericanbarleywine}{American Barleywine}

% Fruit Beer
\newcommand{\stylefruitbeer}{Fruit Beer}

% Spice / Herb / Vegetable Beer
\newcommand{\stylewinterseasonalbeer}{Winter Seasonal Beer}

% Specialty Beer
\newcommand{\stylealternativesugarbeer}{Alternative Sugar Beer}

\newcommand{\sourceaha}{Source: Aermican Homebrewers Association.}
\newcommand{\sourcezymurgy}[1]{Source: Zymurgy #1.}
\newcommand{\waterprofile}[6]{\ce{Ca} #1~ppm, \ce{Mg} #2~ppm, \ce{SO4} #3~ppm, \ce{Na} #4~ppm, \ce{Cl} #5~ppm\ifthenelse{\isempty{#6}}{}{, \ce{HCO3} #6~ppm}}

\newcommand{\specifications}[9]{
\begin{recipeblock}{Specifications}
\begin{tabu} to \textwidth {Xr}
\specitem{Style} & #1 \\ \midrule
\specitem{Volume} & #2 \\ \midrule
\specitem{Original Gravity} & \ifthenelse{\isempty{#3}}{--}{\sgtop{#3} / #3} \\ \midrule
\specitem{Final Gravity} & \ifthenelse{\isempty{#4}}{--}{\sgtop{#4} / #4} \\ \midrule
\specitem{ABV} & \ifthenelse{\isempty{#5}}{--}{#5} \\ \midrule
\specitem{Bitterness} & \ifthenelse{\isempty{#6}}{--}{#6~IBU} \\ \midrule
\specitem{Color} & \ifthenelse{\isempty{#7}}{--}{#7} \\ \midrule
\specitem{Boil Time} & \ifthenelse{\isempty{#8}}{--}{#8} \\ \midrule
\specitem{Carbonation} & \ifthenelse{\isempty{#9}}{--}{#9~vol} \\ \midrule
\end{tabu}
\end{recipeblock}
}

\newgeometry{left=2.5cm,right=2.5cm,top=2.5cm,bottom=3cm}

\RedeclareSectionCommand[beforeskip=0mm,afterindent=false]{chapter}
\renewcommand*{\partpagestyle}{empty} 
